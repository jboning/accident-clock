<html>
<head>
<script src="https://www.gstatic.com/firebasejs/3.6.4/firebase.js"></script>
<script src="https://www.gstatic.com/firebasejs/3.6.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/3.6.2/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/3.6.2/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/3.6.2/firebase-messaging.js"></script>
<script
      src="https://code.jquery.com/jquery-3.1.1.min.js"
        integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
          crossorigin="anonymous"></script>

<script>
  // Initialize Firebase
  var config = {
    apiKey: "AIzaSyA3tP5cEiPiIA81oWdSYrdEfi29r-hyTX4",
    authDomain: "accident-clock.firebaseapp.com",
    databaseURL: "https://accident-clock.firebaseio.com",
    storageBucket: "accident-clock.appspot.com",
    messagingSenderId: "750940402722"
  };
  var app = firebase.initializeApp(config);
  var database = app.database();
  console.log(app.name);
</script>
</head>
<body>
<div id="name">Loading....</div>
<div id="counter"></div>
<form id="resetForm" action="javascript:void(0);">
    <input type="submit" value="Reset" />
</form>
<script>
  id = window.location.hash.substr(1);
  ref = database.ref('clocks/' + id)
  function render(snapshot) {
      $('#name').text(snapshot.val().name);
      $('#counter').text(Math.floor((Date.now() - snapshot.val().time) / 1000) + " seconds");
  }
  ref.on('value', render);
  function tick() {
      ref.once('value').then(render);
  }
  window.setInterval(tick, 1000);
  $('#resetForm').submit(function() {
      console.log("submit!");
      database.ref('clocks/' + id).set({
          name: 'Time since ControlMaster incident',
          time: Date.now(),
      });
  });
</script>
</body>
</html>
